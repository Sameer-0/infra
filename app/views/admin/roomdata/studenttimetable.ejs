<%- include("../partials/head") %>
<%- include("../partials/leftSidebar") %>
<%- include("../partials/header") %>

<div class="col-12 dashboardContent">
  <!--DASHBOARD CONTENT START-->
  <div class="card">
    <div class="card-header">
      <h1 class="f-20">Students Time Table</h1>
    </div>
    <div class="card-body">
      <div class="row">
        <div class="col-sm-6 mt-3">
          <select class="programPicker form-control" id="studentProgramPicker" data-style="btn-info"
            name="programPicker">
            <option disabled selected>--Select Program--</option>
            <% let program; 
            for(program of programList){ %>
            <option value="<%- program.programId %>"><%- program.programName %></option>
            <% } %>
          </select>
        </div>
        <div class="col-sm-6 mt-3">
          <select class="sessionPicker form-control" id="sessionPicker" data-style="btn-info" name="programPicker">
            <option disabled selected>Select Semester</option>
          </select>
        </div>
        <div class="col-sm-6 mt-3">
          <div class="input-group mb-2">
            <div class="input-group-prepend">
              <div class="input-group-text"><i class="fas fa-calendar-alt"></i></div>
            </div>
            <input type="text" class="datePicker form-control" id="datePicker" placeholder="Date" />
          </div>
        </div>
        <div class="col-sm-6 mt-3">
          <button class="btn btn-success w-100" id="fetchTimeTable">Fetch Timetable</button>
        </div>
      </div>
    </div>
  </div>

  <div class="card mt-3">
    <div class="card-body">
      <table class="table table-responsive table-bordered time-table-daywise scroll">
        <thead class="thead-dark">
        </thead>
        <tbody>
        </tbody>
      </table>
    </div>
  </div>


  <!--DASHBOARD CONTENT END-->

 <%- include("../partials/footer") %>

  <script src="/js/daterangepicker.js"></script>

  <script>
    $(document).ready(function () {
      let timeTableDaywise = $(".time-table-daywise")
      let programSel = $("#studentProgramPicker")
      let acadSessionSel = $("#sessionPicker")
      let fetchTimeTable = $("#fetchTimeTable")
      let datePicker =  $('#datePicker')

      datePicker.daterangepicker({
        "singleDatePicker": true,
        "showDropdowns": true,
        "locale": {
          "format": "DD/MM/YYYY"
        },
      }, function (start, end, label) {
        
      });

      

      fetchTimeTable.click(function () {
        $.ajax({
          url: '/roomdata/getStudentTimeTableData/',
          type: 'POST',
          dataType: "json",
          data: {
            selectedDate: datePicker.val()
          },

          success: function (data) {
            if (data.cause == "permission denied") {
							window.location = data.reqUrl
							return
				    }
            let detailsData = JSON.parse(data.data);

            console.log("DATA RECEIVED====>", detailsData);
            let ajaxData = ""
          }

        })
      })

    })
  </script>

  <%- include("../partials/footerEnd") %>